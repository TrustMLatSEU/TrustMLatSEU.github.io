<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trustworthy Machine Learning Group</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-cloud@1.2.5"></script>

</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div>
                    <h1>Trustworthy Machine Learning Group</h1>
                    <p class="subtitle">Weekly Seminar Series</p>
                </div>
                <div class="data-info">
                    <i class="fas fa-database"></i> Data source: meeting.csv
                </div>
            </div>
        </div>
    </header>
    
    <div class="container">
        <div id="display-page">
            <div class="main-content">
                <aside class="sidebar">
                    <div class="about-section">
                        <h2 class="section-title">About Our Group</h2>
                        
                        <h3 class="about-subtitle">Group Introduction</h3>
                        <div class="about-content">
                            <p>We are a research team focused on Trustworthy Machine Learning, led by Professor Wang. Our group is part of the School of Computer Science and Engineering at Southeast University.</p>
                            <p>Our mission is to advance the field of machine learning by developing methods that are robust, fair, transparent, and privacy-preserving.</p>
                        </div>
                        
                        <h3 class="about-subtitle">Research Areas</h3>
                        <ul class="research-areas">
                            <li>Robust and Adversarial ML</li>
                            <li>Fairness and Bias Mitigation</li>
                            <li>Explainable AI and Interpretability</li>
                            <li>Privacy-Preserving ML</li>
                            <li>Ethical AI Development</li>
                        </ul>
                        
                        <div class="tutorial-section">
                            <h3><i class="fas fa-info-circle"></i> How to update meeting data?</h3>
                            <ul>
                                <li>Edit the meeting.csv file in the same directory</li>
                                <li>Add new meetings following the format</li>
                                <li>Changes will be visible after refresh</li>
                                <li>Contact admin for editing permissions</li>
                            </ul>
                        </div>
                    </div>
                </aside>
                
                <main class="content-area">
                    <h2 class="section-title">Meeting Archive
                        <button class="refresh-btn" id="refresh-meetings">
                            <i class="fas fa-sync-alt"></i> Refresh Data
                        </button>
                    </h2>
                    
                    <div class="stats-container" id="stats-container">
                        <!-- Stats will be populated by JavaScript -->
                    </div>

                    <!-- Word Cloud Section -->
                    <div class="word-cloud-title">Paper Titles Word Cloud</div>
                    <div class="word-cloud-controls">
                        <button class="cloud-control-btn active" id="cloud-all">
                            <i class="fas fa-globe"></i> All Topics
                        </button>
                        <button class="cloud-control-btn" id="cloud-recent">
                            <i class="fas fa-clock"></i> Recent Year
                        </button>
                        <button class="cloud-control-btn" id="cloud-animate">
                            <i class="fas fa-play"></i> Animate
                        </button>
                    </div>
                    <div class="word-cloud-container">
                        <div id="word-cloud"></div>
                    </div>
                    
                    <div class="filter-options">
                        <select id="sort-select">
                            <option value="date-desc">Sort by Date (Newest First)</option>
                            <option value="date-asc">Sort by Date (Oldest First)</option>
                            <option value="presenter">Sort by Presenter</option>
                        </select>
                        <input type="text" id="search-input" placeholder="Search presenter, title or conference">
                    </div>
                    
                    <table class="archive-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Presenter</th>
                                <th>Title</th>
                                <th>Conference</th>
                                <th>Year</th>
                                <th>Paper Link</th>
                            </tr>
                        </thead>
                        <tbody id="archive-table-body">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </main>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>© 2025 TrustML Group at SEU | Created by Deng-Bao Wang</p>
            <a href="#" class="view-display-btn" target="_blank">
                <i class="fas fa-external-link-alt"></i> Access the Tencent Docs Spreadsheet
            </a>
        </div>
    </footer>

    <script>
        // Global variable to store meeting data
        let meetings = [];

        // Page elements
        const archiveTableBody = document.getElementById('archive-table-body');
        const sortSelect = document.getElementById('sort-select');
        const searchInput = document.getElementById('search-input');

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Add event listeners
            sortSelect.addEventListener('change', renderArchiveTable);
            searchInput.addEventListener('input', renderArchiveTable);
            
            // Load data from server
            loadCSVData();
        });

        // Function to load CSV data from server
        function loadCSVData() {
            // Show loading state
            archiveTableBody.innerHTML = `
                <tr>
                    <td colspan="6">
                        <div class="loading-indicator">
                            <i class="fas fa-spinner fa-spin"></i>
                            正在从服务器加载会议数据...
                        </div>
                    </td>
                </tr>
            `;
            
            
            // Fetch the CSV file from server
            fetch('meetings.csv')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('无法加载会议数据文件');
                    }
                    return response.text();
                })
                .then(csvText => {
                    try {
                        meetings = parseCSV(csvText);
                        renderArchiveTable();
                    } catch (error) {
                        showError('解析CSV文件时出错: ' + error.message);
                    }
                })
                .catch(error => {
                    showError('加载会议数据时出错: ' + error.message);
                });
        }

        // Parse CSV text to array of objects
        function parseCSV(csvText) {
            const lines = csvText.split('\n').filter(line => line.trim());
            if (lines.length < 2) {
                throw new Error('CSV文件内容不足');
            }
            
            const headers = lines[0].split(',').map(header => header.trim());
            
            const result = [];
            
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                const values = line.split(',').map(value => value.trim());
                
                if (values.length === headers.length) {
                    const meeting = {};
                    headers.forEach((header, index) => {
                        meeting[header] = values[index];
                    });
                    result.push(meeting);
                }
            }
            
            if (result.length === 0) {
                throw new Error('CSV文件中没有有效数据');
            }
            
            return result;
        }


        // Render meeting archive table
        function renderArchiveTable() {
            if (meetings.length === 0) {
                archiveTableBody.innerHTML = `
                    <tr>
                        <td colspan="6">
                            <div class="error-message">
                                <i class="fas fa-exclamation-triangle"></i>
                                没有会议记录可显示。
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Get search keyword
            const searchTerm = searchInput.value.toLowerCase();
            
            // Get sort option
            const sortOption = sortSelect.value;
            
            // Filter meetings
            let filteredMeetings = meetings.filter(meeting => 
                (meeting.Presenter && meeting.Presenter.toLowerCase().includes(searchTerm)) ||
                (meeting.Title && meeting.Title.toLowerCase().includes(searchTerm)) ||
                (meeting.Conference && meeting.Conference.toLowerCase().includes(searchTerm))
            );
            
            // Apply sorting
            switch(sortOption) {
                case 'date-desc':
                    filteredMeetings.sort((a, b) => new Date(b.Date) - new Date(a.Date));
                    break;
                case 'date-asc':
                    filteredMeetings.sort((a, b) => new Date(a.Date) - new Date(b.Date));
                    break;
                case 'presenter':
                    filteredMeetings.sort((a, b) => a.Presenter.localeCompare(b.Presenter));
                    break;
            }
            
            // If no search results
            if (filteredMeetings.length === 0) {
                archiveTableBody.innerHTML = `
                    <tr>
                        <td colspan="6">
                            <div class="error-message">
                                <i class="fas fa-search"></i>
                                没有匹配的会议记录。
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let tableHTML = '';
            
            filteredMeetings.forEach(meeting => {
                const date = new Date(meeting.Date);
                const formattedDate = date.toLocaleDateString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                });
                
                tableHTML += `
                    <tr>
                        <td>${formattedDate}</td>
                        <td><strong>${meeting.Presenter || ''}</strong></td>
                        <td>${meeting.Title || ''}</td>
                        <td>${meeting.Conference || ''}</td>
                        <td>${meeting.Year || ''}</td>
                        <td>
                            <a href="${meeting['Paper Link']}" class="material-link" target="_blank">
                                <i class="fas fa-file-pdf"></i> 查看资料
                            </a>
                        </td>
                    </tr>
                `;
            });
            
            archiveTableBody.innerHTML = tableHTML;
        }

        function showError(message) {
            archiveTableBody.innerHTML = `
                <tr>
                    <td colspan="6">
                        <div class="error-message">
                            <i class="fas fa-exclamation-triangle"></i>
                            ${message}
                        </div>
                    </td>
                </tr>
            `;
        }
    </script>
</body>
</html>