<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trustworthy Machine Learning Group</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-cloud@1.2.5"></script>

</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div>
                    <h1>Trustworthy Machine Learning Group</h1>
                    <p class="subtitle">Weekly Seminar Series</p>
                </div>
            </div>
        </div>
    </header>
    
    <div class="container">
        <div id="display-page">
            <div class="main-content">
                <aside class="sidebar">
                    <div class="about-section">
                        <h2 class="section-title">About Our Group</h2>
                        
                        <h3 class="about-subtitle">Group Introduction</h3>
                        <div class="about-content">
                            <p>We are a research team focused on Trustworthy Machine Learning, led by Professor Wang. Our group is part of the School of Computer Science and Engineering at Southeast University.</p>
                            <p>Our mission is to advance the field of machine learning by developing methods that are robust, fair, transparent, and privacy-preserving.</p>
                        </div>
                        
                        <h3 class="about-subtitle">Research Areas</h3>
                        <ul class="research-areas">
                            <li>Robust and Adversarial ML</li>
                            <li>Fairness and Bias Mitigation</li>
                            <li>Explainable AI and Interpretability</li>
                            <li>Privacy-Preserving ML</li>
                            <li>Ethical AI Development</li>
                        </ul>
                        
                        <div class="tutorial-section">
                            <h3><i class="fas fa-info-circle"></i> How to update meeting data?</h3>
                            <ul>
                                <li>Edit the meeting.csv file in the same directory</li>
                                <li>Add new meetings following the format</li>
                                <li>Changes will be visible after refresh</li>
                                <li>Contact admin for editing permissions</li>
                            </ul>
                        </div>
                    </div>
                </aside>
                
                <main class="content-area">
                    <h2 class="section-title">Upcoming Meeting  <span id="next-date">Loading...</span></h2>
                        <div class="next-meeting-card">
                                <p><strong>Title:</strong> <a href="#" id="next-paper-link"><span id="next-title">Loading...</span></a></p>
                                <p><strong>Conference:</strong> <span id="next-conference">Loading...</span></p>
                                <p><strong>Presenter:</strong> <span id="next-presenter">Loading...</span></p>
                                <p></p>
                                <p><strong>Location:</strong> SEU Computer Science Building, Room 413 &nbsp;&nbsp; Tencent Meeting ID: #000 000 000</p>
                        </div>

                    <h2 class="section-title">Meeting Archive
                        <div class="filter-options">
                            <select id="sort-select">
                                <option value="date-desc">Sort by Date (Newest First)</option>
                                <option value="date-asc">Sort by Date (Oldest First)</option>
                                <option value="presenter">Sort by Presenter</option>
                            </select>
                            <input type="text" id="search-input" placeholder="Search presenter, title or conference">
                        </div>
                    </h2>
                    
                    
                    <table class="archive-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Presenter</th>
                                <th>Title</th>
                                <th>Conference</th>
                                <th>Year</th>
                                <th>Paper Link</th>
                            </tr>
                        </thead>
                        <tbody id="archive-table-body">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </main>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>© 2025 TrustML Group at SEU | Created by Deng-Bao Wang</p>
            <a href="#" class="view-display-btn" target="_blank">
                <i class="fas fa-external-link-alt"></i> Access the Tencent Docs Spreadsheet
            </a>
        </div>
    </footer>

    <script>
        // Global variable to store meeting data
        let meetings = [];

        // Page elements
        const archiveTableBody = document.getElementById('archive-table-body');
        const sortSelect = document.getElementById('sort-select');
        const searchInput = document.getElementById('search-input');

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Add event listeners
            sortSelect.addEventListener('change', renderArchiveTable);
            searchInput.addEventListener('input', renderArchiveTable);
            
            // Load data from server
            loadCSVData();
        });

        // Function to load CSV data from server
        function loadCSVData() {
            // Show loading state
            archiveTableBody.innerHTML = `
                <tr>
                    <td colspan="6">
                        <div class="loading-indicator">
                            <i class="fas fa-spinner fa-spin"></i>
                            正在从服务器加载会议数据...
                        </div>
                    </td>
                </tr>
            `;
            
            // Simulated data - this would be replaced with actual fetch in production
            const simulateData = false; // Set to false to use real fetch
            
            if (simulateData) {
                try {
                    const csvText = `Date,Presenter,Title,Conference,Year,Paper Link
        2025/9/1,Deng-Bao Wang,Urania: Differentially Private Insights into AI Use.,COLM,2025,https://arxiv.org/abs/2506.04681
        2025/8/25,Alice Johnson,Robust Models Against Adversarial Attacks,ICML,2025,https://arxiv.org/abs/2505.12345
        2025/8/18,Bob Smith,Fairness in Recommender Systems,KDD,2025,https://arxiv.org/abs/2504.12345
        2025/8/11,Carol Williams,Privacy-Preserving Federated Learning,NeurIPS,2025,https://arxiv.org/abs/2503.12345
        2025/8/4,David Brown,Interpretable Deep Learning Models,AAAI,2025,https://arxiv.org/abs/2502.12345
        2025/7/28,Emma Davis,Ethical Considerations in AI Deployment,FAccT,2025,https://arxiv.org/abs/2501.12345
        2025/7/21,Frank Miller,Secure Multi-Party Computation for ML,Security,2025,https://arxiv.org/abs/2500.12345
        2025/7/14,Grace Wilson,Transformer Models for Anomaly Detection,ICLR,2025,https://arxiv.org/abs/2499.12345`;
                    
                    meetings = parseCSV(csvText);
                    renderArchiveTable();
                    renderNextMeeting(); // 添加这行
                } catch (error) {
                    showError('解析模拟CSV数据时出错: ' + error.message);
                }
            } else {
                // Original fetch code for production
                fetch('meetings.csv')
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('无法加载会议数据文件');
                        }
                        return response.text();
                    })
                    .then(csvText => {
                        try {
                            meetings = parseCSV(csvText);
                            renderArchiveTable();
                            renderNextMeeting(); // 添加这行
                        } catch (error) {
                            showError('解析CSV文件时出错: ' + error.message);
                        }
                    })                
                    .catch(error => {
                        showError('加载会议数据时出错: ' + error.message);
                    });
            }
        }

        // Parse CSV text to array of objects
        function parseCSV(csvText) {

            const lines = csvText.split('\n').filter(line => line.trim());

            if (lines.length < 2) {
                throw new Error('CSV文件内容不足');
            }
            
            const headers = lines[0].split(',').map(header => header.trim());
            
            const result = [];
            
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                const values = line.split(',').map(value => value.trim());
                
                if (values.length === headers.length) {
                    const meeting = {};
                    headers.forEach((header, index) => {
                        meeting[header] = values[index];
                    });
                    result.push(meeting);
                }
            }
            
            if (result.length === 0) {
                throw new Error('CSV文件中没有有效数据');
            }
            
            return result;
        }


        // Render meeting archive table
        function renderArchiveTable() {
            if (meetings.length === 0) {
                archiveTableBody.innerHTML = `
                    <tr>
                        <td colspan="6">
                            <div class="error-message">
                                <i class="fas fa-exclamation-triangle"></i>
                                没有会议记录可显示。
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Get search keyword
            const searchTerm = searchInput.value.toLowerCase();
            
            // Get sort option
            const sortOption = sortSelect.value;
            
            // Filter meetings
            let filteredMeetings = meetings.filter(meeting => 
                (meeting.Presenter && meeting.Presenter.toLowerCase().includes(searchTerm)) ||
                (meeting.Title && meeting.Title.toLowerCase().includes(searchTerm)) ||
                (meeting.Conference && meeting.Conference.toLowerCase().includes(searchTerm))
            );
            
            // Apply sorting
            switch(sortOption) {
                case 'date-desc':
                    filteredMeetings.sort((a, b) => new Date(b.Date) - new Date(a.Date));
                    break;
                case 'date-asc':
                    filteredMeetings.sort((a, b) => new Date(a.Date) - new Date(b.Date));
                    break;
                case 'presenter':
                    filteredMeetings.sort((a, b) => a.Presenter.localeCompare(b.Presenter));
                    break;
            }
            
            // If no search results
            if (filteredMeetings.length === 0) {
                archiveTableBody.innerHTML = `
                    <tr>
                        <td colspan="6">
                            <div class="error-message">
                                <i class="fas fa-search"></i>
                                没有匹配的会议记录。
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            let tableHTML = '';
            
            filteredMeetings.forEach(meeting => {
                const date = new Date(meeting.Date);
                const formattedDate = date.toLocaleDateString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                });
                
                tableHTML += `
                    <tr>
                        <td>${formattedDate}</td>
                        <td><strong>${meeting.Presenter || ''}</strong></td>
                        <td>${meeting.Title || ''}</td>
                        <td>${meeting.Conference || ''}</td>
                        <td>${meeting.Year || ''}</td>
                        <td>
                            <a href="${meeting['Paper Link']}" class="material-link" target="_blank"> &nbspSlides</a>
                        </td>
                    </tr>
                `;
            });
            
            archiveTableBody.innerHTML = tableHTML;
        }
        // 添加renderNextMeeting函数
        function renderNextMeeting() {
            if (meetings.length === 0) return;
            
            // 找到日期最晚的会议
            const nextMeeting = meetings.reduce((latest, current) => {
                const currentDate = new Date(current.Date);
                const latestDate = new Date(latest.Date);
                return currentDate > latestDate ? current : latest;
            }, meetings[0]);
            
            // 更新DOM元素
            const date = new Date(nextMeeting.Date);
            const formattedDate = date.toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });
            
            document.getElementById('next-date').textContent = formattedDate + ' 14:00';
            document.getElementById('next-presenter').textContent = nextMeeting.Presenter || '';
            document.getElementById('next-title').textContent = nextMeeting.Title || '';
            document.getElementById('next-conference').textContent = nextMeeting.Conference + ' ' + nextMeeting.Year || '';
            
            const paperLink = document.getElementById('next-paper-link');
            if (nextMeeting['Paper Link']) {
                paperLink.href = nextMeeting['Paper Link'];
            } else {
                paperLink.style.display = 'none';
            }
        }

        function showError(message) {
            archiveTableBody.innerHTML = `
                <tr>
                    <td colspan="6">
                        <div class="error-message">
                            <i class="fas fa-exclamation-triangle"></i>
                            ${message}
                        </div>
                    </td>
                </tr>
            `;
        }
    </script>
</body>
</html>